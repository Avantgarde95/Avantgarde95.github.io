<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css"/><link href="https://fonts.cdnfonts.com/css/sf-mono" rel="stylesheet"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-2e51481b1d484a05.js" defer=""></script><script src="/_next/static/chunks/framework-8488625eb441c966.js" defer=""></script><script src="/_next/static/chunks/main-c9e6aaf8f06fd3d9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-54a1ac4fa1cb4b7b.js" defer=""></script><script src="/_next/static/chunks/98-27e89bfd0f963582.js" defer=""></script><script src="/_next/static/chunks/789-49381acb46370e5a.js" defer=""></script><script src="/_next/static/chunks/594-ce5c9f7fb9f56f96.js" defer=""></script><script src="/_next/static/chunks/pages/blog/post/%5Bkey%5D-9fb4c27b2a4484a0.js" defer=""></script><script src="/_next/static/KULxcRVNeukEj5vd7-A5G/_buildManifest.js" defer=""></script><script src="/_next/static/KULxcRVNeukEj5vd7-A5G/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css-global iftqeq">html{width:100%;height:100%;margin:0;padding:0;font-family:"Pretendard",sans-serif;font-size:62.5%;}body{width:100%;height:100%;margin:0;padding:0;}#__next{width:100%;height:100%;}</style><style data-emotion="css 11h3v09">.css-11h3v09{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:100%;height:100%;color:#1f1f1f;background-color:#ffffff;}</style><div class="css-11h3v09 e12ob6f70"><style data-emotion="css ei8rx5">.css-ei8rx5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;max-width:1000px;}</style><div class="css-ei8rx5 e12ob6f71"><style data-emotion="css 1n0l3qb">.css-1n0l3qb{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;width:100%;padding:22px 24px 10px 24px;}</style><div class="css-1n0l3qb e1dz70rv0"><style data-emotion="css 1bnw8zv">.css-1bnw8zv{font-size:14px;font-weight:500;}</style><div class="css-1bnw8zv">00<!-- -->:<!-- -->00</div><style data-emotion="css 18a0bh6">.css-18a0bh6{margin-left:auto;}</style><style data-emotion="css 128qw07">.css-128qw07{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:17px;height:17px;margin-left:auto;}</style><div class="css-128qw07 e1dz70rv1"><svg width="17" height="17" fill="none" xmlns="http://www.w3.org/2000/svg"><path opacity="0.1" d="M8.5 1.417c-3.4 0-6.375 1.487-8.5 3.825l8.5 10.341L17 5.242c-2.125-2.338-5.1-3.825-8.5-3.825Z" fill="#1F1F1F"></path></svg></div><style data-emotion="css 4iefm">.css-4iefm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:17px;height:17px;}</style><div class="css-4iefm e1dz70rv1"><svg width="17" height="17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.583 1.417 1.417 15.583h14.166V1.417Z" fill="#1F1F1F"></path></svg></div><div class="css-4iefm e1dz70rv1"><svg width="8" height="15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 0h-3v1.5H1c-.552 0-1 .504-1 1.125v11.25C0 14.496.448 15 1 15h6c.552 0 1-.504 1-1.125V2.625C8 2.004 7.552 1.5 7 1.5H5.5V0Z" fill="#1F1F1F" fill-opacity="0.3"></path><path d="M0 8v5.95C0 14.53.448 15 1 15h6c.552 0 1-.47 1-1.05V8H0Z" fill="#1F1F1F"></path></svg></div></div><style data-emotion="css 1plrt3">.css-1plrt3{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;width:100%;padding:18px 20px;}</style><header class="css-1plrt3 ecceavf0"><style data-emotion="css 1j4ubxs">.css-1j4ubxs{cursor:pointer;box-sizing:border-box;border:0;padding:0;color:inherit;background-color:transparent;font-family:inherit;font-size:inherit;width:24px;height:24px;min-width:0;min-height:0;margin-right:auto;}</style><style data-emotion="css hxj3u3">.css-hxj3u3{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#1976d2;cursor:pointer;box-sizing:border-box;border:0;padding:0;color:inherit;background-color:transparent;font-family:inherit;font-size:inherit;width:24px;height:24px;min-width:0;min-height:0;margin-right:auto;}.css-hxj3u3:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(25, 118, 210, 0.04);}@media (hover: none){.css-hxj3u3:hover{background-color:transparent;}}.css-hxj3u3.Mui-disabled{color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css pj48ct">.css-pj48ct{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#1976d2;cursor:pointer;box-sizing:border-box;border:0;padding:0;color:inherit;background-color:transparent;font-family:inherit;font-size:inherit;width:24px;height:24px;min-width:0;min-height:0;margin-right:auto;}.css-pj48ct::-moz-focus-inner{border-style:none;}.css-pj48ct.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-pj48ct{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-pj48ct:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(25, 118, 210, 0.04);}@media (hover: none){.css-pj48ct:hover{background-color:transparent;}}.css-pj48ct.Mui-disabled{color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium css-pj48ct" tabindex="0" type="button"><svg width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 18h18M3 12h18M3 6h18" stroke="#1F1F1F" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><style data-emotion="css a3xyjy">.css-a3xyjy{z-index:1200;}</style><style data-emotion="css 1j2lmr9 animation-jotq25">.css-1j2lmr9{margin:0;padding:0;text-align:center;-webkit-flex:1;-ms-flex:1;flex:1;font-size:21px;font-weight:700;opacity:0;-webkit-animation:animation-jotq25 0.5s forwards;animation:animation-jotq25 0.5s forwards;}@-webkit-keyframes animation-jotq25{100%{opacity:1;}}@keyframes animation-jotq25{100%{opacity:1;}}</style><h1 class="css-1j2lmr9 ecceavf1">블로그</h1><style data-emotion="css wakbyj">.css-wakbyj{cursor:pointer;box-sizing:border-box;border:0;padding:0;color:inherit;background-color:transparent;font-family:inherit;font-size:inherit;width:24px;height:24px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;min-width:0;min-height:0;margin-left:auto;}</style><style data-emotion="css 1c6gj7b">.css-1c6gj7b{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#1976d2;cursor:pointer;box-sizing:border-box;border:0;padding:0;color:inherit;background-color:transparent;font-family:inherit;font-size:inherit;width:24px;height:24px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;min-width:0;min-height:0;margin-left:auto;}.css-1c6gj7b:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(25, 118, 210, 0.04);}@media (hover: none){.css-1c6gj7b:hover{background-color:transparent;}}.css-1c6gj7b.Mui-disabled{color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css 1va6h6f">.css-1va6h6f{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#1976d2;cursor:pointer;box-sizing:border-box;border:0;padding:0;color:inherit;background-color:transparent;font-family:inherit;font-size:inherit;width:24px;height:24px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;min-width:0;min-height:0;margin-left:auto;}.css-1va6h6f::-moz-focus-inner{border-style:none;}.css-1va6h6f.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1va6h6f{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1va6h6f:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(25, 118, 210, 0.04);}@media (hover: none){.css-1va6h6f:hover{background-color:transparent;}}.css-1va6h6f.Mui-disabled{color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium css-1va6h6f" tabindex="0" type="button"><style data-emotion="css 1i0bw9d">.css-1i0bw9d{font-size:21px;line-height:21px;opacity:1;-webkit-transition:opacity 1s,font-size 0.3s,line-height 0.3s;transition:opacity 1s,font-size 0.3s,line-height 0.3s;}</style><span class="css-1i0bw9d">가</span><style data-emotion="css bah3n2">.css-bah3n2{font-size:12px;line-height:12px;opacity:0.5;-webkit-transition:opacity 1s,font-size 0.3s,line-height 0.3s;transition:opacity 1s,font-size 0.3s,line-height 0.3s;}</style><span class="css-bah3n2">A</span></button></header><style data-emotion="css 1ej2pvw">.css-1ej2pvw{overflow-y:auto;width:100%;-webkit-flex:1;-ms-flex:1;flex:1;}</style><main class="css-1ej2pvw e12ob6f72"><style data-emotion="css 1jldanx">.css-1jldanx{box-sizing:border-box;width:100%;padding:0 21px;}</style><div class="css-1jldanx e13n4kg82"><style data-emotion="css 1rr6krv">.css-1rr6krv{margin-bottom:2px;font-size:20px;font-weight:bold;}</style><div class="css-1rr6krv e13n4kg83">CRTP (Curiously Recurring Template Pattern)</div><style data-emotion="css 4osezd">.css-4osezd{margin-bottom:16px;font-size:16px;}</style><div class="css-4osezd e13n4kg84">2021-06-10</div><style data-emotion="css yar54t">.css-yar54t{word-break:break-all;width:100%;margin-bottom:8px;font-size:16px;border-top:1px solid #818181;border-bottom:1px solid #818181;}.css-yar54t h1{font-size:20px;}.css-yar54t h2{font-size:18px;}.css-yar54t h3{font-size:16px;}.css-yar54t ul{padding-left:24px;}.css-yar54t a{cursor:pointer;font-weight:normal;color:#3c4fff;}.css-yar54t table{box-sizing:border-box;border-collapse:collapse;border:1px solid #818181;}.css-yar54t table th,.css-yar54t table td{box-sizing:border-box;padding:8px;border:1px solid #818181;}.css-yar54t code{font-family:"SF Mono",monospace!important;}</style><div class="css-yar54t e13n4kg85"><p>C++에서 <strong>CRTP</strong>(묘하게 되풀이되는 템플릿 패턴, Curiously Recurring Template Pattern)라는 재미있는 트릭이 있다.
부모 클래스를 템플릿 클래스로 만들고 자식 클래스가 자기 자신을 템플릿 인수로 넣어 부모 클래스에서 자식 클래스를 사용할 수 있게 하는 트릭이다.</p>
<p>There&#x27;s a fun trick in C++ called CRTP (Curiously Recurring Template Pattern).
The trick is to enable the parent class to use the child class by making the parent class a template class and let the child class to pass itself as a template argument.</p>
<pre><style data-emotion="css femo2h">.css-femo2h{box-sizing:border-box;vertical-align:middle;font-size:13px;padding:0 2px;line-height:16px;background-color:rgba(232,232,232,0.7);}</style><code class="language-cpp css-femo2h e13n4kg80">template &lt;typename Derived&gt;
class MyBase {
    ...
};

class MyDerived: public MyBase&lt;Derived&gt; {
    ...
};
</code></pre>
<p>이 트릭을 이용하면 아래와 같이 싱글톤 베이스 클래스를 제작할 수 있다.
자식 클래스에서 <code class="css-femo2h e13n4kg80">getInstance()</code>를 굳이 만들 필요 없이 싱글톤 베이스 클래스를 상속받고 생성자만 구현해주면 된다.
개인적으로 안정성이 중요한 프로그램들에서 싱글톤들의 라이프사이클을 일괄적으로 관리하고 싶을때 매우 유용하지 않을까 생각한다.</p>
<p>Using this trick, you can create a singleton base class like below.
The child class doesn&#x27;t have to create its own <code class="css-femo2h e13n4kg80">getInstance()</code>. I just need to inherit the singleton base class and implement its constructor.
Personally, I think it would be very useful when you want to manage the lifecycle of singletons in the programs where stability is important.</p>
<pre><code class="language-cpp css-femo2h e13n4kg80">template &lt;typename Derived&gt;
class Singleton {
public:
    static const Derived* getInstance() {
        if (m_instance == nullptr) {
            // Call the constructor of the child class (by using CRTP).
            m_instance = new Derived();
        }

        return m_instance;
    }

private:
    static Derived* m_instance;
};

template &lt;typename Derived&gt;
Derived* Singleton&lt;Derived&gt;::m_instance = nullptr;

class Manager : public Singleton&lt;Manager&gt; {
public:
    Manager() {
        m_status = &quot;Manager is created!&quot;;
    }

public:
    const std::string&amp; getStatus() const {
        return m_status;
    }

private:
    std::string m_status;
};
</code></pre></div><div class="css-4osezd e13n4kg86">Category: <style data-emotion="css 1tpbm6x">.css-1tpbm6x{-webkit-text-decoration:none;text-decoration:none;color:inherit;font-family:inherit;font-size:inherit;color:#3c4fff;}</style><a class="css-1tpbm6x e13n4kg87" href="/blog/category/computer/">Computer</a></div><style data-emotion="css vd5och">.css-vd5och{margin-top:32px;margin-bottom:128px;font-size:16px;}</style><div class="css-vd5och">Loading the comments...</div><div id="disqus_thread"></div></div></main></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"key":"crtp","title":"CRTP (Curiously Recurring Template Pattern)","time":1623283200000,"category":"Computer","content":"C++에서 **CRTP**(묘하게 되풀이되는 템플릿 패턴, Curiously Recurring Template Pattern)라는 재미있는 트릭이 있다.\n부모 클래스를 템플릿 클래스로 만들고 자식 클래스가 자기 자신을 템플릿 인수로 넣어 부모 클래스에서 자식 클래스를 사용할 수 있게 하는 트릭이다.\n\nThere's a fun trick in C++ called CRTP (Curiously Recurring Template Pattern).\nThe trick is to enable the parent class to use the child class by making the parent class a template class and let the child class to pass itself as a template argument.\n\n```cpp\ntemplate \u003ctypename Derived\u003e\nclass MyBase {\n    ...\n};\n\nclass MyDerived: public MyBase\u003cDerived\u003e {\n    ...\n};\n```\n\n이 트릭을 이용하면 아래와 같이 싱글톤 베이스 클래스를 제작할 수 있다.\n자식 클래스에서 `getInstance()`를 굳이 만들 필요 없이 싱글톤 베이스 클래스를 상속받고 생성자만 구현해주면 된다.\n개인적으로 안정성이 중요한 프로그램들에서 싱글톤들의 라이프사이클을 일괄적으로 관리하고 싶을때 매우 유용하지 않을까 생각한다.\n\nUsing this trick, you can create a singleton base class like below.\nThe child class doesn't have to create its own `getInstance()`. I just need to inherit the singleton base class and implement its constructor.\nPersonally, I think it would be very useful when you want to manage the lifecycle of singletons in the programs where stability is important.\n\n```cpp\ntemplate \u003ctypename Derived\u003e\nclass Singleton {\npublic:\n    static const Derived* getInstance() {\n        if (m_instance == nullptr) {\n            // Call the constructor of the child class (by using CRTP).\n            m_instance = new Derived();\n        }\n\n        return m_instance;\n    }\n\nprivate:\n    static Derived* m_instance;\n};\n\ntemplate \u003ctypename Derived\u003e\nDerived* Singleton\u003cDerived\u003e::m_instance = nullptr;\n\nclass Manager : public Singleton\u003cManager\u003e {\npublic:\n    Manager() {\n        m_status = \"Manager is created!\";\n    }\n\npublic:\n    const std::string\u0026 getStatus() const {\n        return m_status;\n    }\n\nprivate:\n    std::string m_status;\n};\n```\n"}},"__N_SSG":true},"page":"/blog/post/[key]","query":{"key":"crtp"},"buildId":"KULxcRVNeukEj5vd7-A5G","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>